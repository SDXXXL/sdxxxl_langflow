<!DOCTYPE html><html class="default" lang="en" data-base="../"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>deepagents - v1.6.0 | langchain.js</title><meta name="description" content="Documentation for langchain.js"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script><!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-MBBX68ST');</script>
<!-- End Google Tag Manager --></head><body><!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MBBX68ST"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) --><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => window.app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><a href="../index.html" class="title">langchain.js</a><div id="tsd-toolbar-links"></div><button id="tsd-search-trigger" class="tsd-widget" aria-label="Search"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></button><dialog id="tsd-search" aria-label="Search"><input role="combobox" id="tsd-search-input" aria-controls="tsd-search-results" aria-autocomplete="list" aria-expanded="true" autocapitalize="off" autocomplete="off" placeholder="Search the docs" maxLength="100"/><ul role="listbox" id="tsd-search-results"></ul><div id="tsd-search-status" aria-live="polite" aria-atomic="true"><div>Preparing search index...</div></div></dialog><a href="#" class="tsd-widget menu" id="tsd-toolbar-menu-trigger" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb" aria-label="Breadcrumb"><li><a href="" aria-current="page">deepagents</a></li></ul><h1>Module deepagents - v1.6.0</h1></div><section class="tsd-panel tsd-typography"><h1 id="üß†ü§ñ-deep-agents" class="tsd-anchor-link">üß†ü§ñ Deep Agents<a href="#üß†ü§ñ-deep-agents" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><p>Using an LLM to call tools in a loop is the simplest form of an agent.
This architecture, however, can yield agents that are &quot;shallow&quot; and fail to plan and act over longer, more complex tasks.</p>
<p>Applications like &quot;Deep Research&quot;, &quot;Manus&quot;, and &quot;Claude Code&quot; have gotten around this limitation by implementing a combination of four things:
a <strong>planning tool</strong>, <strong>sub agents</strong>, access to a <strong>file system</strong>, and a <strong>detailed prompt</strong>.</p>
<blockquote>
<p>üí° <strong>Tip:</strong> Looking for the Python version of this package? See <a href="https://github.com/langchain-ai/deepagents" target="_blank" class="external">langchain-ai/deepagents</a></p>
</blockquote>
<p><img src="https://blog.langchain.com/content/images/2025/07/Screenshot-2025-07-30-at-9.08.32-AM.png" alt="Deep Agents"></p>
<p><code>deepagents</code> is a TypeScript package that implements these in a general purpose way so that you can easily create a Deep Agent for your application.</p>
<p><strong>Acknowledgements: This project was primarily inspired by Claude Code, and initially was largely an attempt to see what made Claude Code general purpose, and make it even more so.</strong></p>
<p><a href="https://www.npmjs.com/package/deepagents" target="_blank" class="external"><img src="https://img.shields.io/npm/v/deepagents.svg" alt="npm version"></a>
<a href="https://opensource.org/licenses/MIT" target="_blank" class="external"><img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="License: MIT"></a>
<a href="https://www.typescriptlang.org/" target="_blank" class="external"><img src="https://img.shields.io/badge/TypeScript-5.0+-blue.svg" alt="TypeScript"></a></p>
<p><a href="https://docs.langchain.com/oss/javascript/deepagents/overview" target="_blank" class="external">Documentation</a> | <a href="./examples">Examples</a> | <a href="https://github.com/langchain-ai/deepagentsjs/issues" target="_blank" class="external">Report Bug</a> | <a href="https://github.com/langchain-ai/deepagentsjs/issues" target="_blank" class="external">Request Feature</a></p>
<h2 id="üìñ-overview" class="tsd-anchor-link">üìñ Overview<a href="#üìñ-overview" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Using an LLM to call tools in a loop is the simplest form of an agent. However, this architecture can yield agents that are &quot;shallow&quot; and fail to plan and act over longer, more complex tasks.</p>
<p>Applications like <strong>Deep Research</strong>, <strong>Manus</strong>, and <strong>Claude Code</strong> have overcome this limitation by implementing a combination of four key components:</p>
<ol>
<li><strong>Planning Tool</strong> - Strategic task decomposition</li>
<li><strong>Sub-Agents</strong> - Specialized agents for subtasks</li>
<li><strong>File System Access</strong> - Persistent state and memory</li>
<li><strong>Detailed Prompts</strong> - Context-rich instructions</li>
</ol>
<p><strong>Deep Agents</strong> is a TypeScript package that implements these patterns in a general-purpose way, enabling you to easily create sophisticated agents for your applications.</p>
<h2 id="‚ú®-features" class="tsd-anchor-link">‚ú® Features<a href="#‚ú®-features" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li>üéØ <strong>Task Planning &amp; Decomposition</strong> - Break complex tasks into manageable steps</li>
<li>ü§ñ <strong>Sub-Agent Architecture</strong> - Delegate specialized work to focused agents</li>
<li>üíæ <strong>File System Integration</strong> - Persistent memory and state management</li>
<li>üåä <strong>Streaming Support</strong> - Real-time updates, token streaming, and progress tracking</li>
<li>üîÑ <strong>LangGraph Powered</strong> - Built on the robust LangGraph framework</li>
<li>üìù <strong>TypeScript First</strong> - Full type safety and IntelliSense support</li>
<li>üîå <strong>Extensible</strong> - Easy to customize and extend for your use case</li>
</ul>
<h2 id="installation" class="tsd-anchor-link">Installation<a href="#installation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="bash"><span class="hl-8"># npm</span><br/><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">deepagents</span><br/><br/><span class="hl-8"># yarn</span><br/><span class="hl-0">yarn</span><span class="hl-1"> </span><span class="hl-2">add</span><span class="hl-1"> </span><span class="hl-2">deepagents</span><br/><br/><span class="hl-8"># pnpm</span><br/><span class="hl-0">pnpm</span><span class="hl-1"> </span><span class="hl-2">add</span><span class="hl-1"> </span><span class="hl-2">deepagents</span>
</code><button type="button">Copy</button></pre>

<h2 id="usage" class="tsd-anchor-link">Usage<a href="#usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>(To run the example below, you will need to <code>npm install @langchain/tavily</code>).</p>
<p>Make sure to set <code>TAVILY_API_KEY</code> in your environment. You can generate one <a href="https://www.tavily.com/" target="_blank" class="external">here</a>.</p>
<pre><code class="typescript"><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">tool</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;langchain&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">TavilySearch</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@langchain/tavily&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">createDeepAgent</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;deepagents&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">z</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;zod&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-8">// Web search tool</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">internetSearch</span><span class="hl-1"> = </span><span class="hl-0">tool</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-0">async</span><span class="hl-1"> ({</span><br/><span class="hl-1">    </span><span class="hl-5">query</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">maxResults</span><span class="hl-1"> = </span><span class="hl-12">5</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">topic</span><span class="hl-1"> = </span><span class="hl-2">&quot;general&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">includeRawContent</span><span class="hl-1"> = </span><span class="hl-4">false</span><span class="hl-1">,</span><br/><span class="hl-1">  }: {</span><br/><span class="hl-1">    </span><span class="hl-5">query:</span><span class="hl-1"> </span><span class="hl-5">string</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-5">maxResults</span><span class="hl-1">?: </span><span class="hl-5">number</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-5">topic</span><span class="hl-1">?: </span><span class="hl-2">&quot;general&quot;</span><span class="hl-1"> | </span><span class="hl-2">&quot;news&quot;</span><span class="hl-1"> | </span><span class="hl-2">&quot;finance&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-5">includeRawContent</span><span class="hl-1">?: </span><span class="hl-5">boolean</span><span class="hl-1">;</span><br/><span class="hl-1">  }) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">tavilySearch</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">TavilySearch</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-5">maxResults</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">tavilyApiKey:</span><span class="hl-1"> </span><span class="hl-5">process</span><span class="hl-1">.</span><span class="hl-5">env</span><span class="hl-1">.</span><span class="hl-7">TAVILY_API_KEY</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">includeRawContent</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">topic</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><span class="hl-6">return</span><span class="hl-1"> </span><span class="hl-6">await</span><span class="hl-1"> </span><span class="hl-5">tavilySearch</span><span class="hl-1">.</span><span class="hl-0">_call</span><span class="hl-1">({ </span><span class="hl-5">query</span><span class="hl-1"> });</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  {</span><br/><span class="hl-1">    </span><span class="hl-5">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;internet_search&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">description:</span><span class="hl-1"> </span><span class="hl-2">&quot;Run a web search&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">schema:</span><span class="hl-1"> </span><span class="hl-5">z</span><span class="hl-1">.</span><span class="hl-0">object</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-5">query:</span><span class="hl-1"> </span><span class="hl-5">z</span><span class="hl-1">.</span><span class="hl-0">string</span><span class="hl-1">().</span><span class="hl-0">describe</span><span class="hl-1">(</span><span class="hl-2">&quot;The search query&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-5">maxResults:</span><span class="hl-1"> </span><span class="hl-5">z</span><br/><span class="hl-1">        .</span><span class="hl-0">number</span><span class="hl-1">()</span><br/><span class="hl-1">        .</span><span class="hl-0">optional</span><span class="hl-1">()</span><br/><span class="hl-1">        .</span><span class="hl-0">default</span><span class="hl-1">(</span><span class="hl-12">5</span><span class="hl-1">)</span><br/><span class="hl-1">        .</span><span class="hl-0">describe</span><span class="hl-1">(</span><span class="hl-2">&quot;Maximum number of results to return&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-5">topic:</span><span class="hl-1"> </span><span class="hl-5">z</span><br/><span class="hl-1">        .</span><span class="hl-0">enum</span><span class="hl-1">([</span><span class="hl-2">&quot;general&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;news&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;finance&quot;</span><span class="hl-1">])</span><br/><span class="hl-1">        .</span><span class="hl-0">optional</span><span class="hl-1">()</span><br/><span class="hl-1">        .</span><span class="hl-0">default</span><span class="hl-1">(</span><span class="hl-2">&quot;general&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">        .</span><span class="hl-0">describe</span><span class="hl-1">(</span><span class="hl-2">&quot;Search topic category&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-5">includeRawContent:</span><span class="hl-1"> </span><span class="hl-5">z</span><br/><span class="hl-1">        .</span><span class="hl-0">boolean</span><span class="hl-1">()</span><br/><span class="hl-1">        .</span><span class="hl-0">optional</span><span class="hl-1">()</span><br/><span class="hl-1">        .</span><span class="hl-0">default</span><span class="hl-1">(</span><span class="hl-4">false</span><span class="hl-1">)</span><br/><span class="hl-1">        .</span><span class="hl-0">describe</span><span class="hl-1">(</span><span class="hl-2">&quot;Whether to include raw content&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">    }),</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">);</span><br/><br/><span class="hl-8">// System prompt to steer the agent to be an expert researcher</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">researchInstructions</span><span class="hl-1"> = </span><span class="hl-2">`You are an expert researcher. Your job is to conduct thorough research, and then write a polished report.</span><br/><br/><span class="hl-2">You have access to an internet search tool as your primary means of gathering information.</span><br/><br/><span class="hl-2">## </span><span class="hl-10">\`</span><span class="hl-2">internet_search</span><span class="hl-10">\`</span><br/><br/><span class="hl-2">Use this to run an internet search for a given query. You can specify the max number of results to return, the topic, and whether raw content should be included.</span><br/><span class="hl-2">`</span><span class="hl-1">;</span><br/><br/><span class="hl-8">// Create the deep agent</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">agent</span><span class="hl-1"> = </span><span class="hl-0">createDeepAgent</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">tools:</span><span class="hl-1"> [</span><span class="hl-5">internetSearch</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-5">systemPrompt:</span><span class="hl-1"> </span><span class="hl-5">researchInstructions</span><span class="hl-1">,</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-8">// Invoke the agent</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">result</span><span class="hl-1"> = </span><span class="hl-6">await</span><span class="hl-1"> </span><span class="hl-5">agent</span><span class="hl-1">.</span><span class="hl-0">invoke</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">messages:</span><span class="hl-1"> [{ </span><span class="hl-5">role:</span><span class="hl-1"> </span><span class="hl-2">&quot;user&quot;</span><span class="hl-1">, </span><span class="hl-5">content:</span><span class="hl-1"> </span><span class="hl-2">&quot;What is langgraph?&quot;</span><span class="hl-1"> }],</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>See <a href="examples/research/research-agent.ts">examples/research/research-agent.ts</a> for a more complex example.</p>
<p>The agent created with <code>createDeepAgent</code> is just a LangGraph graph - so you can interact with it (streaming, human-in-the-loop, memory, studio)
in the same way you would any LangGraph agent.</p>
<h2 id="core-capabilities" class="tsd-anchor-link">Core Capabilities<a href="#core-capabilities" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><strong>Planning &amp; Task Decomposition</strong></p>
<p>Deep Agents include a built-in <code>write_todos</code> tool that enables agents to break down complex tasks into discrete steps, track progress, and adapt plans as new information emerges.</p>
<p><strong>Context Management</strong></p>
<p>File system tools (<code>ls</code>, <code>read_file</code>, <code>write_file</code>, <code>edit_file</code>, <code>glob</code>, <code>grep</code>) allow agents to offload large context to memory, preventing context window overflow and enabling work with variable-length tool results.</p>
<p><strong>Subagent Spawning</strong></p>
<p>A built-in <code>task</code> tool enables agents to spawn specialized subagents for context isolation. This keeps the main agent's context clean while still going deep on specific subtasks.</p>
<p><strong>Long-term Memory</strong></p>
<p>Extend agents with persistent memory across threads using LangGraph's Store. Agents can save and retrieve information from previous conversations.</p>
<h2 id="customizing-deep-agents" class="tsd-anchor-link">Customizing Deep Agents<a href="#customizing-deep-agents" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>There are several parameters you can pass to <code>createDeepAgent</code> to create your own custom deep agent.</p>
<h3 id="model" class="tsd-anchor-link"><code>model</code><a href="#model" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>By default, <code>deepagents</code> uses <code>&quot;claude-sonnet-4-5-20250929&quot;</code>. You can customize this by passing any <a href="https://js.langchain.com/docs/integrations/chat/" target="_blank" class="external">LangChain model object</a>.</p>
<pre><code class="typescript"><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">ChatAnthropic</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@langchain/anthropic&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">ChatOpenAI</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@langchain/openai&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">createDeepAgent</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;deepagents&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-8">// Using Anthropic</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">agent</span><span class="hl-1"> = </span><span class="hl-0">createDeepAgent</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">model:</span><span class="hl-1"> </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">ChatAnthropic</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">model:</span><span class="hl-1"> </span><span class="hl-2">&quot;claude-sonnet-4-20250514&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">temperature:</span><span class="hl-1"> </span><span class="hl-12">0</span><span class="hl-1">,</span><br/><span class="hl-1">  }),</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-8">// Using OpenAI</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">agent2</span><span class="hl-1"> = </span><span class="hl-0">createDeepAgent</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">model:</span><span class="hl-1"> </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">ChatOpenAI</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">model:</span><span class="hl-1"> </span><span class="hl-2">&quot;gpt-5&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">temperature:</span><span class="hl-1"> </span><span class="hl-12">0</span><span class="hl-1">,</span><br/><span class="hl-1">  }),</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<h3 id="systemprompt" class="tsd-anchor-link"><code>systemPrompt</code><a href="#systemprompt" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Deep Agents come with a built-in system prompt. This is relatively detailed prompt that is heavily based on and inspired by <a href="https://github.com/kn1026/cc/blob/main/claudecode.md" target="_blank" class="external">attempts</a> to <a href="https://github.com/asgeirtj/system_prompts_leaks/blob/main/Anthropic/claude-code.md" target="_blank" class="external">replicate</a>
Claude Code's system prompt. It was made more general purpose than Claude Code's system prompt. The default prompt contains detailed instructions for how to use the built-in planning tool, file system tools, and sub agents.</p>
<p>Each deep agent tailored to a use case should include a custom system prompt specific to that use case as well. The importance of prompting for creating a successful deep agent cannot be overstated.</p>
<pre><code class="typescript"><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">createDeepAgent</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;deepagents&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">researchInstructions</span><span class="hl-1"> = </span><span class="hl-2">`You are an expert researcher. Your job is to conduct thorough research, and then write a polished report.`</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">agent</span><span class="hl-1"> = </span><span class="hl-0">createDeepAgent</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">systemPrompt:</span><span class="hl-1"> </span><span class="hl-5">researchInstructions</span><span class="hl-1">,</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<h3 id="tools" class="tsd-anchor-link"><code>tools</code><a href="#tools" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Just like with tool-calling agents, you can provide a deep agent with a set of tools that it has access to.</p>
<pre><code class="typescript"><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">tool</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;langchain&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">TavilySearch</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@langchain/tavily&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">createDeepAgent</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;deepagents&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">z</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;zod&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">internetSearch</span><span class="hl-1"> = </span><span class="hl-0">tool</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-0">async</span><span class="hl-1"> ({</span><br/><span class="hl-1">    </span><span class="hl-5">query</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">maxResults</span><span class="hl-1"> = </span><span class="hl-12">5</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">topic</span><span class="hl-1"> = </span><span class="hl-2">&quot;general&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">includeRawContent</span><span class="hl-1"> = </span><span class="hl-4">false</span><span class="hl-1">,</span><br/><span class="hl-1">  }: {</span><br/><span class="hl-1">    </span><span class="hl-5">query:</span><span class="hl-1"> </span><span class="hl-5">string</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-5">maxResults</span><span class="hl-1">?: </span><span class="hl-5">number</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-5">topic</span><span class="hl-1">?: </span><span class="hl-2">&quot;general&quot;</span><span class="hl-1"> | </span><span class="hl-2">&quot;news&quot;</span><span class="hl-1"> | </span><span class="hl-2">&quot;finance&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-5">includeRawContent</span><span class="hl-1">?: </span><span class="hl-5">boolean</span><span class="hl-1">;</span><br/><span class="hl-1">  }) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">tavilySearch</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">TavilySearch</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-5">maxResults</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">tavilyApiKey:</span><span class="hl-1"> </span><span class="hl-5">process</span><span class="hl-1">.</span><span class="hl-5">env</span><span class="hl-1">.</span><span class="hl-7">TAVILY_API_KEY</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">includeRawContent</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">topic</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><span class="hl-6">return</span><span class="hl-1"> </span><span class="hl-6">await</span><span class="hl-1"> </span><span class="hl-5">tavilySearch</span><span class="hl-1">.</span><span class="hl-0">_call</span><span class="hl-1">({ </span><span class="hl-5">query</span><span class="hl-1"> });</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  {</span><br/><span class="hl-1">    </span><span class="hl-5">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;internet_search&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">description:</span><span class="hl-1"> </span><span class="hl-2">&quot;Run a web search&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">schema:</span><span class="hl-1"> </span><span class="hl-5">z</span><span class="hl-1">.</span><span class="hl-0">object</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-5">query:</span><span class="hl-1"> </span><span class="hl-5">z</span><span class="hl-1">.</span><span class="hl-0">string</span><span class="hl-1">().</span><span class="hl-0">describe</span><span class="hl-1">(</span><span class="hl-2">&quot;The search query&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-5">maxResults:</span><span class="hl-1"> </span><span class="hl-5">z</span><span class="hl-1">.</span><span class="hl-0">number</span><span class="hl-1">().</span><span class="hl-0">optional</span><span class="hl-1">().</span><span class="hl-0">default</span><span class="hl-1">(</span><span class="hl-12">5</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-5">topic:</span><span class="hl-1"> </span><span class="hl-5">z</span><br/><span class="hl-1">        .</span><span class="hl-0">enum</span><span class="hl-1">([</span><span class="hl-2">&quot;general&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;news&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;finance&quot;</span><span class="hl-1">])</span><br/><span class="hl-1">        .</span><span class="hl-0">optional</span><span class="hl-1">()</span><br/><span class="hl-1">        .</span><span class="hl-0">default</span><span class="hl-1">(</span><span class="hl-2">&quot;general&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-5">includeRawContent:</span><span class="hl-1"> </span><span class="hl-5">z</span><span class="hl-1">.</span><span class="hl-0">boolean</span><span class="hl-1">().</span><span class="hl-0">optional</span><span class="hl-1">().</span><span class="hl-0">default</span><span class="hl-1">(</span><span class="hl-4">false</span><span class="hl-1">),</span><br/><span class="hl-1">    }),</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">);</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">agent</span><span class="hl-1"> = </span><span class="hl-0">createDeepAgent</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">tools:</span><span class="hl-1"> [</span><span class="hl-5">internetSearch</span><span class="hl-1">],</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<h3 id="middleware" class="tsd-anchor-link"><code>middleware</code><a href="#middleware" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><code>createDeepAgent</code> is implemented with middleware that can be customized. You can provide additional middleware to extend functionality, add tools, or implement custom hooks.</p>
<pre><code class="typescript"><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">tool</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;langchain&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">createDeepAgent</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;deepagents&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">import</span><span class="hl-1"> </span><span class="hl-6">type</span><span class="hl-1"> { </span><span class="hl-5">AgentMiddleware</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;langchain&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">z</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;zod&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">getWeather</span><span class="hl-1"> = </span><span class="hl-0">tool</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">async</span><span class="hl-1"> ({ </span><span class="hl-5">city</span><span class="hl-1"> }: { </span><span class="hl-5">city</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1"> }) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">return</span><span class="hl-1"> </span><span class="hl-2">`The weather in </span><span class="hl-4">${</span><span class="hl-5">city</span><span class="hl-4">}</span><span class="hl-2"> is sunny.`</span><span class="hl-1">;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  {</span><br/><span class="hl-1">    </span><span class="hl-5">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;get_weather&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">description:</span><span class="hl-1"> </span><span class="hl-2">&quot;Get the weather in a city.&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">schema:</span><span class="hl-1"> </span><span class="hl-5">z</span><span class="hl-1">.</span><span class="hl-0">object</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-5">city:</span><span class="hl-1"> </span><span class="hl-5">z</span><span class="hl-1">.</span><span class="hl-0">string</span><span class="hl-1">().</span><span class="hl-0">describe</span><span class="hl-1">(</span><span class="hl-2">&quot;The city to get weather for&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">    }),</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">);</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">getTemperature</span><span class="hl-1"> = </span><span class="hl-0">tool</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">async</span><span class="hl-1"> ({ </span><span class="hl-5">city</span><span class="hl-1"> }: { </span><span class="hl-5">city</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1"> }) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">return</span><span class="hl-1"> </span><span class="hl-2">`The temperature in </span><span class="hl-4">${</span><span class="hl-5">city</span><span class="hl-4">}</span><span class="hl-2"> is 70 degrees Fahrenheit.`</span><span class="hl-1">;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  {</span><br/><span class="hl-1">    </span><span class="hl-5">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;get_temperature&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">description:</span><span class="hl-1"> </span><span class="hl-2">&quot;Get the temperature in a city.&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">schema:</span><span class="hl-1"> </span><span class="hl-5">z</span><span class="hl-1">.</span><span class="hl-0">object</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-5">city:</span><span class="hl-1"> </span><span class="hl-5">z</span><span class="hl-1">.</span><span class="hl-0">string</span><span class="hl-1">().</span><span class="hl-0">describe</span><span class="hl-1">(</span><span class="hl-2">&quot;The city to get temperature for&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">    }),</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">);</span><br/><br/><span class="hl-4">class</span><span class="hl-1"> </span><span class="hl-9">WeatherMiddleware</span><span class="hl-1"> </span><span class="hl-4">implements</span><span class="hl-1"> </span><span class="hl-9">AgentMiddleware</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">tools</span><span class="hl-1"> = [</span><span class="hl-5">getWeather</span><span class="hl-1">, </span><span class="hl-5">getTemperature</span><span class="hl-1">];</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">agent</span><span class="hl-1"> = </span><span class="hl-0">createDeepAgent</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">model:</span><span class="hl-1"> </span><span class="hl-2">&quot;claude-sonnet-4-20250514&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">middleware:</span><span class="hl-1"> [</span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">WeatherMiddleware</span><span class="hl-1">()],</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<h3 id="subagents" class="tsd-anchor-link"><code>subagents</code><a href="#subagents" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>A main feature of Deep Agents is their ability to spawn subagents. You can specify custom subagents that your agent can hand off work to in the subagents parameter. Sub agents are useful for context quarantine (to help not pollute the overall context of the main agent) as well as custom instructions.</p>
<p><code>subagents</code> should be a list of objects that follow the <code>SubAgent</code> interface:</p>
<pre><code class="typescript"><span class="hl-4">interface</span><span class="hl-1"> </span><span class="hl-9">SubAgent</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">name</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-5">description</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-5">systemPrompt</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-5">tools</span><span class="hl-1">?: </span><span class="hl-9">StructuredTool</span><span class="hl-1">[];</span><br/><span class="hl-1">  </span><span class="hl-5">model</span><span class="hl-1">?: </span><span class="hl-9">LanguageModelLike</span><span class="hl-1"> | </span><span class="hl-9">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-5">middleware</span><span class="hl-1">?: </span><span class="hl-9">AgentMiddleware</span><span class="hl-1">[];</span><br/><span class="hl-1">  </span><span class="hl-5">interruptOn</span><span class="hl-1">?: </span><span class="hl-9">Record</span><span class="hl-1">&lt;</span><span class="hl-9">string</span><span class="hl-1">, </span><span class="hl-9">boolean</span><span class="hl-1"> | </span><span class="hl-9">InterruptOnConfig</span><span class="hl-1">&gt;;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>SubAgent fields:</strong></p>
<ul>
<li><strong>name</strong>: This is the name of the subagent, and how the main agent will call the subagent</li>
<li><strong>description</strong>: This is the description of the subagent that is shown to the main agent</li>
<li><strong>systemPrompt</strong>: This is the prompt used for the subagent</li>
<li><strong>tools</strong>: This is the list of tools that the subagent has access to.</li>
<li><strong>model</strong>: Optional model name or model instance.</li>
<li><strong>middleware</strong>: Additional middleware to attach to the subagent. See <a href="https://docs.langchain.com/oss/typescript/langchain/middleware" target="_blank" class="external">here</a> for an introduction into middleware and how it works with createAgent.</li>
<li><strong>interruptOn</strong>: A custom interrupt config that specifies human-in-the-loop interactions for your tools.</li>
</ul>
<h4 id="using-subagent" class="tsd-anchor-link">Using SubAgent<a href="#using-subagent" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">tool</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;langchain&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">TavilySearch</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@langchain/tavily&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">createDeepAgent</span><span class="hl-1">, </span><span class="hl-6">type</span><span class="hl-1"> </span><span class="hl-5">SubAgent</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;deepagents&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">z</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;zod&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">internetSearch</span><span class="hl-1"> = </span><span class="hl-0">tool</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-0">async</span><span class="hl-1"> ({</span><br/><span class="hl-1">    </span><span class="hl-5">query</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">maxResults</span><span class="hl-1"> = </span><span class="hl-12">5</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">topic</span><span class="hl-1"> = </span><span class="hl-2">&quot;general&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">includeRawContent</span><span class="hl-1"> = </span><span class="hl-4">false</span><span class="hl-1">,</span><br/><span class="hl-1">  }: {</span><br/><span class="hl-1">    </span><span class="hl-5">query:</span><span class="hl-1"> </span><span class="hl-5">string</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-5">maxResults</span><span class="hl-1">?: </span><span class="hl-5">number</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-5">topic</span><span class="hl-1">?: </span><span class="hl-2">&quot;general&quot;</span><span class="hl-1"> | </span><span class="hl-2">&quot;news&quot;</span><span class="hl-1"> | </span><span class="hl-2">&quot;finance&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-5">includeRawContent</span><span class="hl-1">?: </span><span class="hl-5">boolean</span><span class="hl-1">;</span><br/><span class="hl-1">  }) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">tavilySearch</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">TavilySearch</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-5">maxResults</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">tavilyApiKey:</span><span class="hl-1"> </span><span class="hl-5">process</span><span class="hl-1">.</span><span class="hl-5">env</span><span class="hl-1">.</span><span class="hl-7">TAVILY_API_KEY</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">includeRawContent</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">topic</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><span class="hl-6">return</span><span class="hl-1"> </span><span class="hl-6">await</span><span class="hl-1"> </span><span class="hl-5">tavilySearch</span><span class="hl-1">.</span><span class="hl-0">_call</span><span class="hl-1">({ </span><span class="hl-5">query</span><span class="hl-1"> });</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  {</span><br/><span class="hl-1">    </span><span class="hl-5">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;internet_search&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">description:</span><span class="hl-1"> </span><span class="hl-2">&quot;Run a web search&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">schema:</span><span class="hl-1"> </span><span class="hl-5">z</span><span class="hl-1">.</span><span class="hl-0">object</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-5">query:</span><span class="hl-1"> </span><span class="hl-5">z</span><span class="hl-1">.</span><span class="hl-0">string</span><span class="hl-1">(),</span><br/><span class="hl-1">      </span><span class="hl-5">maxResults:</span><span class="hl-1"> </span><span class="hl-5">z</span><span class="hl-1">.</span><span class="hl-0">number</span><span class="hl-1">().</span><span class="hl-0">optional</span><span class="hl-1">().</span><span class="hl-0">default</span><span class="hl-1">(</span><span class="hl-12">5</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-5">topic:</span><span class="hl-1"> </span><span class="hl-5">z</span><br/><span class="hl-1">        .</span><span class="hl-0">enum</span><span class="hl-1">([</span><span class="hl-2">&quot;general&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;news&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;finance&quot;</span><span class="hl-1">])</span><br/><span class="hl-1">        .</span><span class="hl-0">optional</span><span class="hl-1">()</span><br/><span class="hl-1">        .</span><span class="hl-0">default</span><span class="hl-1">(</span><span class="hl-2">&quot;general&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-5">includeRawContent:</span><span class="hl-1"> </span><span class="hl-5">z</span><span class="hl-1">.</span><span class="hl-0">boolean</span><span class="hl-1">().</span><span class="hl-0">optional</span><span class="hl-1">().</span><span class="hl-0">default</span><span class="hl-1">(</span><span class="hl-4">false</span><span class="hl-1">),</span><br/><span class="hl-1">    }),</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">);</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">researchSubagent</span><span class="hl-1">: </span><span class="hl-9">SubAgent</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-5">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;research-agent&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">description:</span><span class="hl-1"> </span><span class="hl-2">&quot;Used to research more in depth questions&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">systemPrompt:</span><span class="hl-1"> </span><span class="hl-2">&quot;You are a great researcher&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">tools:</span><span class="hl-1"> [</span><span class="hl-5">internetSearch</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-5">model:</span><span class="hl-1"> </span><span class="hl-2">&quot;gpt-4o&quot;</span><span class="hl-1">, </span><span class="hl-8">// Optional override, defaults to main agent model</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">subagents</span><span class="hl-1"> = [</span><span class="hl-5">researchSubagent</span><span class="hl-1">];</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">agent</span><span class="hl-1"> = </span><span class="hl-0">createDeepAgent</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">model:</span><span class="hl-1"> </span><span class="hl-2">&quot;claude-sonnet-4-20250514&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">subagents:</span><span class="hl-1"> </span><span class="hl-5">subagents</span><span class="hl-1">,</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<h3 id="interrupton" class="tsd-anchor-link"><code>interruptOn</code><a href="#interrupton" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>A common reality for agents is that some tool operations may be sensitive and require human approval before execution. Deep Agents supports human-in-the-loop workflows through LangGraph's interrupt capabilities. You can configure which tools require approval using a checkpointer.</p>
<p>These tool configs are passed to our prebuilt <a href="https://docs.langchain.com/oss/typescript/langchain/middleware#human-in-the-loop" target="_blank" class="external">HITL middleware</a> so that the agent pauses execution and waits for feedback from the user before executing configured tools.</p>
<pre><code class="typescript"><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">tool</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;langchain&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">createDeepAgent</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;deepagents&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">z</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;zod&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">getWeather</span><span class="hl-1"> = </span><span class="hl-0">tool</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">async</span><span class="hl-1"> ({ </span><span class="hl-5">city</span><span class="hl-1"> }: { </span><span class="hl-5">city</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1"> }) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">return</span><span class="hl-1"> </span><span class="hl-2">`The weather in </span><span class="hl-4">${</span><span class="hl-5">city</span><span class="hl-4">}</span><span class="hl-2"> is sunny.`</span><span class="hl-1">;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  {</span><br/><span class="hl-1">    </span><span class="hl-5">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;get_weather&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">description:</span><span class="hl-1"> </span><span class="hl-2">&quot;Get the weather in a city.&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">schema:</span><span class="hl-1"> </span><span class="hl-5">z</span><span class="hl-1">.</span><span class="hl-0">object</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-5">city:</span><span class="hl-1"> </span><span class="hl-5">z</span><span class="hl-1">.</span><span class="hl-0">string</span><span class="hl-1">(),</span><br/><span class="hl-1">    }),</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">);</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">agent</span><span class="hl-1"> = </span><span class="hl-0">createDeepAgent</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">model:</span><span class="hl-1"> </span><span class="hl-2">&quot;claude-sonnet-4-20250514&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">tools:</span><span class="hl-1"> [</span><span class="hl-5">getWeather</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-5">interruptOn:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">get_weather:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">allowedDecisions:</span><span class="hl-1"> [</span><span class="hl-2">&quot;approve&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;edit&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;reject&quot;</span><span class="hl-1">],</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<h3 id="backend" class="tsd-anchor-link"><code>backend</code><a href="#backend" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Deep Agents use backends to manage file system operations and memory storage. You can configure different backends depending on your needs:</p>
<pre><code class="typescript"><span class="hl-6">import</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">createDeepAgent</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">StateBackend</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">StoreBackend</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">FilesystemBackend</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">CompositeBackend</span><span class="hl-1">,</span><br/><span class="hl-1">} </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;deepagents&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">MemorySaver</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@langchain/langgraph&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">InMemoryStore</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@langchain/langgraph-checkpoint&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-8">// Default: StateBackend (in-memory, ephemeral)</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">agent1</span><span class="hl-1"> = </span><span class="hl-0">createDeepAgent</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-8">// No backend specified - uses StateBackend by default</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-8">// StoreBackend: Persistent storage using LangGraph Store</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">agent2</span><span class="hl-1"> = </span><span class="hl-0">createDeepAgent</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-0">backend</span><span class="hl-5">:</span><span class="hl-1"> (</span><span class="hl-5">config</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">StoreBackend</span><span class="hl-1">(</span><span class="hl-5">config</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-5">store:</span><span class="hl-1"> </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">InMemoryStore</span><span class="hl-1">(), </span><span class="hl-8">// Provide a store</span><br/><span class="hl-1">  </span><span class="hl-5">checkpointer:</span><span class="hl-1"> </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">MemorySaver</span><span class="hl-1">(), </span><span class="hl-8">// Optional: for conversation persistence</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-8">// FilesystemBackend: Store files on actual filesystem</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">agent3</span><span class="hl-1"> = </span><span class="hl-0">createDeepAgent</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-0">backend</span><span class="hl-5">:</span><span class="hl-1"> (</span><span class="hl-5">config</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">FilesystemBackend</span><span class="hl-1">({ </span><span class="hl-5">rootDir:</span><span class="hl-1"> </span><span class="hl-2">&quot;./agent-workspace&quot;</span><span class="hl-1"> }),</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-8">// CompositeBackend: Combine multiple backends</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">agent4</span><span class="hl-1"> = </span><span class="hl-0">createDeepAgent</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-0">backend</span><span class="hl-5">:</span><span class="hl-1"> (</span><span class="hl-5">config</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><br/><span class="hl-1">    </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">CompositeBackend</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-5">state:</span><span class="hl-1"> </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">StateBackend</span><span class="hl-1">(</span><span class="hl-5">config</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-5">store:</span><span class="hl-1"> </span><span class="hl-5">config</span><span class="hl-1">.</span><span class="hl-5">store</span><span class="hl-1"> ? </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">StoreBackend</span><span class="hl-1">(</span><span class="hl-5">config</span><span class="hl-1">) : </span><span class="hl-4">undefined</span><span class="hl-1">,</span><br/><span class="hl-1">    }),</span><br/><span class="hl-1">  </span><span class="hl-5">store:</span><span class="hl-1"> </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">InMemoryStore</span><span class="hl-1">(),</span><br/><span class="hl-1">  </span><span class="hl-5">checkpointer:</span><span class="hl-1"> </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">MemorySaver</span><span class="hl-1">(),</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>See <a href="examples/backends/">examples/backends/</a> for detailed examples of each backend type.</p>
<h3 id="sandbox-execution" class="tsd-anchor-link">Sandbox Execution<a href="#sandbox-execution" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>For agents that need to run shell commands, you can create a sandbox backend by extending <code>BaseSandbox</code>. This enables the <code>execute</code> tool which allows agents to run arbitrary shell commands in an isolated environment.</p>
<pre><code class="typescript"><span class="hl-6">import</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">createDeepAgent</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">BaseSandbox</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">type</span><span class="hl-1"> </span><span class="hl-5">ExecuteResponse</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">type</span><span class="hl-1"> </span><span class="hl-5">FileUploadResponse</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">type</span><span class="hl-1"> </span><span class="hl-5">FileDownloadResponse</span><span class="hl-1">,</span><br/><span class="hl-1">} </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;deepagents&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">spawn</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;child_process&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-8">// Create a concrete sandbox by extending BaseSandbox</span><br/><span class="hl-4">class</span><span class="hl-1"> </span><span class="hl-9">LocalShellSandbox</span><span class="hl-1"> </span><span class="hl-4">extends</span><span class="hl-1"> </span><span class="hl-9">BaseSandbox</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">readonly</span><span class="hl-1"> </span><span class="hl-5">id</span><span class="hl-1"> = </span><span class="hl-2">&quot;local-shell&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">private</span><span class="hl-1"> </span><span class="hl-4">readonly</span><span class="hl-1"> </span><span class="hl-5">workingDirectory</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">;</span><br/><br/><span class="hl-1">  </span><span class="hl-4">constructor</span><span class="hl-1">(</span><span class="hl-5">workingDirectory</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">super</span><span class="hl-1">();</span><br/><span class="hl-1">    </span><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-5">workingDirectory</span><span class="hl-1"> = </span><span class="hl-5">workingDirectory</span><span class="hl-1">;</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-8">// Only execute() is required - BaseSandbox implements all file operations</span><br/><span class="hl-1">  </span><span class="hl-4">async</span><span class="hl-1"> </span><span class="hl-0">execute</span><span class="hl-1">(</span><span class="hl-5">command</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">): </span><span class="hl-9">Promise</span><span class="hl-1">&lt;</span><span class="hl-9">ExecuteResponse</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">    </span><span class="hl-6">return</span><span class="hl-1"> </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-9">Promise</span><span class="hl-1">((</span><span class="hl-5">resolve</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">child</span><span class="hl-1"> = </span><span class="hl-0">spawn</span><span class="hl-1">(</span><span class="hl-2">&quot;/bin/bash&quot;</span><span class="hl-1">, [</span><span class="hl-2">&quot;-c&quot;</span><span class="hl-1">, </span><span class="hl-5">command</span><span class="hl-1">], {</span><br/><span class="hl-1">        </span><span class="hl-5">cwd:</span><span class="hl-1"> </span><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-5">workingDirectory</span><span class="hl-1">,</span><br/><span class="hl-1">      });</span><br/><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">chunks</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">[] = [];</span><br/><span class="hl-1">      </span><span class="hl-5">child</span><span class="hl-1">.</span><span class="hl-5">stdout</span><span class="hl-1">.</span><span class="hl-0">on</span><span class="hl-1">(</span><span class="hl-2">&quot;data&quot;</span><span class="hl-1">, (</span><span class="hl-5">data</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-5">chunks</span><span class="hl-1">.</span><span class="hl-0">push</span><span class="hl-1">(</span><span class="hl-5">data</span><span class="hl-1">.</span><span class="hl-0">toString</span><span class="hl-1">()));</span><br/><span class="hl-1">      </span><span class="hl-5">child</span><span class="hl-1">.</span><span class="hl-5">stderr</span><span class="hl-1">.</span><span class="hl-0">on</span><span class="hl-1">(</span><span class="hl-2">&quot;data&quot;</span><span class="hl-1">, (</span><span class="hl-5">data</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-5">chunks</span><span class="hl-1">.</span><span class="hl-0">push</span><span class="hl-1">(</span><span class="hl-5">data</span><span class="hl-1">.</span><span class="hl-0">toString</span><span class="hl-1">()));</span><br/><br/><span class="hl-1">      </span><span class="hl-5">child</span><span class="hl-1">.</span><span class="hl-0">on</span><span class="hl-1">(</span><span class="hl-2">&quot;close&quot;</span><span class="hl-1">, (</span><span class="hl-5">exitCode</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">resolve</span><span class="hl-1">({</span><br/><span class="hl-1">          </span><span class="hl-5">output:</span><span class="hl-1"> </span><span class="hl-5">chunks</span><span class="hl-1">.</span><span class="hl-0">join</span><span class="hl-1">(</span><span class="hl-2">&quot;&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">          </span><span class="hl-5">exitCode</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-5">truncated:</span><span class="hl-1"> </span><span class="hl-4">false</span><span class="hl-1">,</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-4">async</span><span class="hl-1"> </span><span class="hl-0">uploadFiles</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-5">files</span><span class="hl-1">: </span><span class="hl-9">Array</span><span class="hl-1">&lt;[</span><span class="hl-9">string</span><span class="hl-1">, </span><span class="hl-9">Uint8Array</span><span class="hl-1">]&gt;,</span><br/><span class="hl-1">  ): </span><span class="hl-9">Promise</span><span class="hl-1">&lt;</span><span class="hl-9">FileUploadResponse</span><span class="hl-1">[]&gt; {</span><br/><span class="hl-1">    </span><span class="hl-8">// Implement file upload logic</span><br/><span class="hl-1">    </span><span class="hl-6">return</span><span class="hl-1"> </span><span class="hl-5">files</span><span class="hl-1">.</span><span class="hl-0">map</span><span class="hl-1">(([</span><span class="hl-5">path</span><span class="hl-1">]) </span><span class="hl-4">=&gt;</span><span class="hl-1"> ({ </span><span class="hl-5">path</span><span class="hl-1">, </span><span class="hl-5">error:</span><span class="hl-1"> </span><span class="hl-4">null</span><span class="hl-1"> }));</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-4">async</span><span class="hl-1"> </span><span class="hl-0">downloadFiles</span><span class="hl-1">(</span><span class="hl-5">paths</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">[]): </span><span class="hl-9">Promise</span><span class="hl-1">&lt;</span><span class="hl-9">FileDownloadResponse</span><span class="hl-1">[]&gt; {</span><br/><span class="hl-1">    </span><span class="hl-8">// Implement file download logic</span><br/><span class="hl-1">    </span><span class="hl-6">return</span><span class="hl-1"> </span><span class="hl-5">paths</span><span class="hl-1">.</span><span class="hl-0">map</span><span class="hl-1">((</span><span class="hl-5">path</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> ({</span><br/><span class="hl-1">      </span><span class="hl-5">path</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">content:</span><span class="hl-1"> </span><span class="hl-4">null</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">error:</span><span class="hl-1"> </span><span class="hl-2">&quot;file_not_found&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    }));</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-8">// Use the sandbox with your agent</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">sandbox</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">LocalShellSandbox</span><span class="hl-1">(</span><span class="hl-2">&quot;./workspace&quot;</span><span class="hl-1">);</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">agent</span><span class="hl-1"> = </span><span class="hl-0">createDeepAgent</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">backend:</span><span class="hl-1"> </span><span class="hl-5">sandbox</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">systemPrompt:</span><span class="hl-1"> </span><span class="hl-2">&quot;You can run shell commands using the execute tool.&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>When using a sandbox backend, the agent gains access to an <code>execute</code> tool that can run shell commands. The tool automatically returns the command output, exit code, and whether the output was truncated.</p>
<p>See <a href="examples/sandbox/local-sandbox.ts">examples/sandbox/local-sandbox.ts</a> for a complete implementation.</p>
<h2 id="deep-agents-middleware" class="tsd-anchor-link">Deep Agents Middleware<a href="#deep-agents-middleware" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Deep Agents are built with a modular middleware architecture. As a reminder, Deep Agents have access to:</p>
<ul>
<li>A planning tool</li>
<li>A filesystem for storing context and long-term memories</li>
<li>The ability to spawn subagents</li>
</ul>
<p>Each of these features is implemented as separate middleware. When you create a deep agent with <code>createDeepAgent</code>, we automatically attach <strong>todoListMiddleware</strong>, <strong>FilesystemMiddleware</strong> and <strong>SubAgentMiddleware</strong> to your agent.</p>
<p>Middleware is a composable concept, and you can choose to add as many or as few middleware to an agent depending on your use case. That means that you can also use any of the aforementioned middleware independently!</p>
<h3 id="todolistmiddleware" class="tsd-anchor-link">TodoListMiddleware<a href="#todolistmiddleware" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Planning is integral to solving complex problems. If you've used claude code recently, you'll notice how it writes out a To-Do list before tackling complex, multi-part tasks. You'll also notice how it can adapt and update this To-Do list on the fly as more information comes in.</p>
<p><strong>todoListMiddleware</strong> provides your agent with a tool specifically for updating this To-Do list. Before, and while it executes a multi-part task, the agent is prompted to use the write_todos tool to keep track of what its doing, and what still needs to be done.</p>
<pre><code class="typescript"><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">createAgent</span><span class="hl-1">, </span><span class="hl-5">todoListMiddleware</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;langchain&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-8">// todoListMiddleware is included by default in createDeepAgent</span><br/><span class="hl-8">// You can customize it if building a custom agent</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">agent</span><span class="hl-1"> = </span><span class="hl-0">createAgent</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">model:</span><span class="hl-1"> </span><span class="hl-2">&quot;claude-sonnet-4-20250514&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">middleware:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-0">todoListMiddleware</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-8">// Optional: Custom addition to the system prompt</span><br/><span class="hl-1">      </span><span class="hl-5">systemPrompt:</span><span class="hl-1"> </span><span class="hl-2">&quot;Use the write_todos tool to...&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    }),</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<h3 id="filesystemmiddleware" class="tsd-anchor-link">FilesystemMiddleware<a href="#filesystemmiddleware" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Context engineering is one of the main challenges in building effective agents. This can be particularly hard when using tools that can return variable length results (ex. web_search, rag), as long ToolResults can quickly fill up your context window.</p>
<p><strong>FilesystemMiddleware</strong> provides tools to your agent to interact with both short-term and long-term memory:</p>
<ul>
<li><strong>ls</strong>: List the files in your filesystem</li>
<li><strong>read_file</strong>: Read an entire file, or a certain number of lines from a file</li>
<li><strong>write_file</strong>: Write a new file to your filesystem</li>
<li><strong>edit_file</strong>: Edit an existing file in your filesystem</li>
<li><strong>glob</strong>: Find files matching a pattern</li>
<li><strong>grep</strong>: Search for text within files</li>
<li><strong>execute</strong>: Run shell commands (only available when using a <code>SandboxBackendProtocol</code>)</li>
</ul>
<pre><code class="typescript"><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">createAgent</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;langchain&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">createFilesystemMiddleware</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;deepagents&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-8">// FilesystemMiddleware is included by default in createDeepAgent</span><br/><span class="hl-8">// You can customize it if building a custom agent</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">agent</span><span class="hl-1"> = </span><span class="hl-0">createAgent</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">model:</span><span class="hl-1"> </span><span class="hl-2">&quot;claude-sonnet-4-20250514&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">middleware:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-0">createFilesystemMiddleware</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-5">backend:</span><span class="hl-1"> ..., </span><span class="hl-8">// Optional: customize storage backend</span><br/><span class="hl-1">      </span><span class="hl-5">systemPrompt:</span><span class="hl-1"> </span><span class="hl-2">&quot;Write to the filesystem when...&quot;</span><span class="hl-1">, </span><span class="hl-8">// Optional custom system prompt override</span><br/><span class="hl-1">      </span><span class="hl-5">customToolDescriptions:</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-5">ls:</span><span class="hl-1"> </span><span class="hl-2">&quot;Use the ls tool when...&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-5">read_file:</span><span class="hl-1"> </span><span class="hl-2">&quot;Use the read_file tool to...&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      }, </span><span class="hl-8">// Optional: Custom descriptions for filesystem tools</span><br/><span class="hl-1">    }),</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<h3 id="subagentmiddleware" class="tsd-anchor-link">SubAgentMiddleware<a href="#subagentmiddleware" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Handing off tasks to subagents is a great way to isolate context, keeping the context window of the main (supervisor) agent clean while still going deep on a task. The subagents middleware allows you supply subagents through a task tool.</p>
<p>A subagent is defined with a name, description, system prompt, and tools. You can also provide a subagent with a custom model, or with additional middleware. This can be particularly useful when you want to give the subagent an additional state key to share with the main agent.</p>
<pre><code class="typescript"><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">tool</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;langchain&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">createAgent</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;langchain&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">createSubAgentMiddleware</span><span class="hl-1">, </span><span class="hl-6">type</span><span class="hl-1"> </span><span class="hl-5">SubAgent</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;deepagents&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-5">z</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;zod&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">getWeather</span><span class="hl-1"> = </span><span class="hl-0">tool</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">async</span><span class="hl-1"> ({ </span><span class="hl-5">city</span><span class="hl-1"> }: { </span><span class="hl-5">city</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1"> }) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">return</span><span class="hl-1"> </span><span class="hl-2">`The weather in </span><span class="hl-4">${</span><span class="hl-5">city</span><span class="hl-4">}</span><span class="hl-2"> is sunny.`</span><span class="hl-1">;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  {</span><br/><span class="hl-1">    </span><span class="hl-5">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;get_weather&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">description:</span><span class="hl-1"> </span><span class="hl-2">&quot;Get the weather in a city.&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">schema:</span><span class="hl-1"> </span><span class="hl-5">z</span><span class="hl-1">.</span><span class="hl-0">object</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-5">city:</span><span class="hl-1"> </span><span class="hl-5">z</span><span class="hl-1">.</span><span class="hl-0">string</span><span class="hl-1">(),</span><br/><span class="hl-1">    }),</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">);</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">weatherSubagent</span><span class="hl-1">: </span><span class="hl-9">SubAgent</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-5">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;weather&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">description:</span><span class="hl-1"> </span><span class="hl-2">&quot;This subagent can get weather in cities.&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">systemPrompt:</span><span class="hl-1"> </span><span class="hl-2">&quot;Use the get_weather tool to get the weather in a city.&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">tools:</span><span class="hl-1"> [</span><span class="hl-5">getWeather</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-5">model:</span><span class="hl-1"> </span><span class="hl-2">&quot;gpt-4o&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">middleware:</span><span class="hl-1"> [],</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">agent</span><span class="hl-1"> = </span><span class="hl-0">createAgent</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">model:</span><span class="hl-1"> </span><span class="hl-2">&quot;claude-sonnet-4-20250514&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">middleware:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-0">createSubAgentMiddleware</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-5">defaultModel:</span><span class="hl-1"> </span><span class="hl-2">&quot;claude-sonnet-4-20250514&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">defaultTools:</span><span class="hl-1"> [],</span><br/><span class="hl-1">      </span><span class="hl-5">subagents:</span><span class="hl-1"> [</span><span class="hl-5">weatherSubagent</span><span class="hl-1">],</span><br/><span class="hl-1">    }),</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

</section></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h3>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h3>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#üß†ü§ñ-deep-agents"><span>üß†ü§ñ <wbr/>Deep <wbr/>Agents</span></a><ul><li><a href="#üìñ-overview"><span>üìñ <wbr/>Overview</span></a></li><li><a href="#‚ú®-features"><span>‚ú® <wbr/>Features</span></a></li><li><a href="#installation"><span>Installation</span></a></li><li><a href="#usage"><span>Usage</span></a></li><li><a href="#core-capabilities"><span>Core <wbr/>Capabilities</span></a></li><li><a href="#customizing-deep-agents"><span>Customizing <wbr/>Deep <wbr/>Agents</span></a></li><li><ul><li><a href="#model"><span>model</span></a></li><li><a href="#systemprompt"><span>system<wbr/>Prompt</span></a></li><li><a href="#tools"><span>tools</span></a></li><li><a href="#middleware"><span>middleware</span></a></li><li><a href="#subagents"><span>subagents</span></a></li><li><ul><li><a href="#using-subagent"><span>Using <wbr/>Sub<wbr/>Agent</span></a></li></ul></li><li><a href="#interrupton"><span>interrupt<wbr/>On</span></a></li><li><a href="#backend"><span>backend</span></a></li><li><a href="#sandbox-execution"><span>Sandbox <wbr/>Execution</span></a></li></ul></li><li><a href="#deep-agents-middleware"><span>Deep <wbr/>Agents <wbr/>Middleware</span></a></li><li><ul><li><a href="#todolistmiddleware"><span>Todo<wbr/>List<wbr/>Middleware</span></a></li><li><a href="#filesystemmiddleware"><span>Filesystem<wbr/>Middleware</span></a></li><li><a href="#subagentmiddleware"><span>Sub<wbr/>Agent<wbr/>Middleware</span></a></li></ul></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../index.html">langchain.js</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>